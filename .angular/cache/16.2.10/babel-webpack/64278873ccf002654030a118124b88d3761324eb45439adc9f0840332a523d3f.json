{"ast":null,"code":"// Copyright (c) 2015 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n'use strict';\n\nmodule.exports = StringRW;\nvar inherits = require('util').inherits;\nvar ReadResult = require('./base').ReadResult;\nvar errors = require('./errors');\nvar BufferRW = require('./base').BufferRW;\nfunction StringRW(sizerw, encoding) {\n  if (!(this instanceof StringRW)) {\n    return new StringRW(sizerw, encoding);\n  }\n  this.sizerw = sizerw;\n  this.encoding = encoding || 'utf8';\n  if (!this.sizerw.width) {\n    this.poolWriteInto = this.poolWriteVariableWidthInto;\n  } else {\n    this.poolWriteInto = this.poolWriteFixedWidthInto;\n  }\n  BufferRW.call(this);\n}\ninherits(StringRW, BufferRW);\nStringRW.prototype.poolByteLength = function poolByteLength(destResult, str) {\n  var length = 0;\n  if (typeof str === 'string') {\n    length = Buffer.byteLength(str, this.encoding);\n  } else if (str !== null && str !== undefined) {\n    return destResult.reset(errors.expected(str, 'string, null, or undefined'), null);\n  }\n  this.sizerw.poolByteLength(destResult, length);\n  if (destResult.err) return destResult;\n  return destResult.reset(null, destResult.length + length);\n};\nStringRW.prototype.poolWriteFixedWidthInto = function poolWriteFixedWidthInto(destResult, str, buffer, offset) {\n  var start = offset + this.sizerw.width;\n  var length = 0;\n  if (typeof str === 'string') {\n    length = buffer.write(str, start, this.encoding);\n  } else if (str !== null && str !== undefined) {\n    return destResult.reset(errors.expected(str, 'string, null, or undefined'), offset);\n  }\n  this.sizerw.poolWriteInto(destResult, length, buffer, offset);\n  // istanbul ignore if\n  if (destResult.err) return destResult;\n  return destResult.reset(null, start + length);\n};\nStringRW.prototype.poolWriteVariableWidthInto = function poolWriteVariableWidthInto(destResult, str, buffer, offset) {\n  var size = 0;\n  if (typeof str === 'string') {\n    size = Buffer.byteLength(str, this.encoding);\n  } else if (str !== null && str !== undefined) {\n    return destResult.reset(errors.expected(str, 'string, null, or undefined'), offset);\n  }\n  var res = this.sizerw.poolWriteInto(destResult, size, buffer, offset);\n  if (res.err) return res;\n  offset = res.offset;\n  if (typeof str === 'string') {\n    res.offset += buffer.write(str, offset, this.encoding);\n  }\n  return res;\n};\nStringRW.prototype.poolReadFrom = function poolReadFrom(destResult, buffer, offset) {\n  var res = this.sizerw.poolReadFrom(destResult, buffer, offset);\n  if (res.err) return res;\n  var length = res.value;\n  var remain = buffer.length - res.offset;\n  if (remain < length) {\n    return ReadResult.poolShortError(destResult, length, remain, offset, res.offset);\n  } else {\n    offset = res.offset;\n    var end = offset + length;\n    var str = buffer.toString(this.encoding, offset, end);\n    return destResult.reset(null, end, str);\n  }\n};","map":{"version":3,"names":["module","exports","StringRW","inherits","require","ReadResult","errors","BufferRW","sizerw","encoding","width","poolWriteInto","poolWriteVariableWidthInto","poolWriteFixedWidthInto","call","prototype","poolByteLength","destResult","str","length","Buffer","byteLength","undefined","reset","expected","err","buffer","offset","start","write","size","res","poolReadFrom","value","remain","poolShortError","end","toString"],"sources":["/home/bvpelt/Develop/openteltest/node_modules/bufrw/string_rw.js"],"sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n'use strict';\n\nmodule.exports = StringRW;\n\nvar inherits = require('util').inherits;\n\nvar ReadResult = require('./base').ReadResult;\nvar errors = require('./errors');\nvar BufferRW = require('./base').BufferRW;\n\nfunction StringRW(sizerw, encoding) {\n    if (!(this instanceof StringRW)) {\n        return new StringRW(sizerw, encoding);\n    }\n    this.sizerw = sizerw;\n    this.encoding = encoding || 'utf8';\n    if (!this.sizerw.width) {\n        this.poolWriteInto = this.poolWriteVariableWidthInto;\n    } else {\n        this.poolWriteInto = this.poolWriteFixedWidthInto;\n    }\n\n    BufferRW.call(this);\n}\ninherits(StringRW, BufferRW);\n\nStringRW.prototype.poolByteLength = function poolByteLength(destResult, str) {\n    var length = 0;\n    if (typeof str === 'string') {\n        length = Buffer.byteLength(str, this.encoding);\n    } else if (str !== null && str !== undefined) {\n        return destResult.reset(errors.expected(str, 'string, null, or undefined'), null);\n    }\n    this.sizerw.poolByteLength(destResult, length);\n    if (destResult.err) return destResult;\n    return destResult.reset(null, destResult.length + length);\n};\n\nStringRW.prototype.poolWriteFixedWidthInto = \nfunction poolWriteFixedWidthInto(destResult, str, buffer, offset) {\n    var start = offset + this.sizerw.width;\n    var length = 0;\n    if (typeof str === 'string') {\n        length = buffer.write(str, start, this.encoding);\n    } else if (str !== null && str !== undefined) {\n        return destResult.reset(errors.expected(str, 'string, null, or undefined'), offset);\n    }\n    this.sizerw.poolWriteInto(destResult, length, buffer, offset);\n    // istanbul ignore if\n    if (destResult.err) return destResult;\n    return destResult.reset(null, start + length);\n};\n\nStringRW.prototype.poolWriteVariableWidthInto = \nfunction poolWriteVariableWidthInto(destResult, str, buffer, offset) {\n    var size = 0;\n    if (typeof str === 'string') {\n        size = Buffer.byteLength(str, this.encoding);\n    } else if (str !== null && str !== undefined) {\n        return destResult.reset(errors.expected(str, 'string, null, or undefined'), offset);\n    }\n    var res = this.sizerw.poolWriteInto(destResult, size, buffer, offset);\n    if (res.err) return res;\n    offset = res.offset;\n    if (typeof str === 'string') {\n        res.offset += buffer.write(str, offset, this.encoding);\n    }\n    return res;\n};\n\nStringRW.prototype.poolReadFrom = function poolReadFrom(destResult, buffer, offset) {\n    var res = this.sizerw.poolReadFrom(destResult, buffer, offset);\n    if (res.err) return res;\n    var length = res.value;\n    var remain = buffer.length - res.offset;\n    if (remain < length) {\n        return ReadResult.poolShortError(destResult, length, remain, offset, res.offset);\n    } else {\n        offset = res.offset;\n        var end = offset + length;\n        var str = buffer.toString(this.encoding, offset, end);\n        return destResult.reset(null, end, str);\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}