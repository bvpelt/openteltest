{"ast":null,"code":"// Copyright (c) 2015 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n'use strict';\n\nvar WriteResult = require('./base').WriteResult;\nvar ReadResult = require('./base').ReadResult;\nvar BufferRW = require('./base').BufferRW;\nvar errors = require('./errors');\n\n// TODO: zigzag support for signed-s\n\nmodule.exports.unsigned = BufferRW(unsignedVarIntByteLength, readUnsignedVarIntFrom, writeUnsignedVarIntInto, true);\nfunction unsignedVarIntByteLength(destResult, n) {\n  if (typeof n !== 'number' || n < 0) {\n    // TODO: integer check\n    return destResult.reset(errors.expected(n, 'unsigned integer'));\n  }\n  if (n === 0) return destResult.reset(null, 1);\n  var needed = Math.ceil(countBits(n) / 7);\n  return destResult.reset(null, needed);\n}\nfunction writeUnsignedVarIntInto(destResult, n, buffer, offset) {\n  if (typeof n !== 'number' || n < 0) {\n    // TODO: integer check\n    return destResult.reset(errors.expected(n, 'unsigned integer'), null);\n  }\n  var needed = Math.ceil(countBits(n) / 7);\n  var start = offset;\n  var end = offset + needed;\n  if (end > buffer.length) {\n    var remain = buffer.length - offset;\n    return WriteResult.poolShortError(destResult, needed, remain, offset);\n  }\n  offset = end;\n  while (offset > start) {\n    var b = n & 0x7f;\n    n >>= 7;\n    if (offset !== end) b |= 0x80;\n    buffer.writeUInt8(b, --offset, true);\n    if (n <= 0) break;\n  }\n  return destResult.reset(null, end);\n}\nfunction readUnsignedVarIntFrom(destResult, buffer, offset) {\n  var start = offset;\n  var n = 0;\n  while (offset < buffer.length) {\n    var b = buffer.readUInt8(offset++, true);\n    if (n !== 0) n <<= 7;\n    n += b & 0x7f;\n    if (!(b & 0x80)) {\n      return destResult.reset(null, offset, n);\n    }\n  }\n  var got = offset - start;\n  return ReadResult.poolShortError(destResult, got + 1, got, start, offset);\n}\nfunction countBits(n) {\n  var res = 1;\n  while (n >>= 1) res++;\n  return res;\n}","map":{"version":3,"names":["WriteResult","require","ReadResult","BufferRW","errors","module","exports","unsigned","unsignedVarIntByteLength","readUnsignedVarIntFrom","writeUnsignedVarIntInto","destResult","n","reset","expected","needed","Math","ceil","countBits","buffer","offset","start","end","length","remain","poolShortError","b","writeUInt8","readUInt8","got","res"],"sources":["/home/bvpelt/Develop/openteltest/node_modules/bufrw/varint.js"],"sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n'use strict';\n\nvar WriteResult = require('./base').WriteResult;\nvar ReadResult = require('./base').ReadResult;\nvar BufferRW = require('./base').BufferRW;\nvar errors = require('./errors');\n\n// TODO: zigzag support for signed-s\n\nmodule.exports.unsigned = BufferRW(\n    unsignedVarIntByteLength,\n    readUnsignedVarIntFrom,\n    writeUnsignedVarIntInto,\n    true);\n\nfunction unsignedVarIntByteLength(destResult, n) {\n    if (typeof n !== 'number' || n < 0) {\n        // TODO: integer check\n        return destResult.reset(errors.expected(n, 'unsigned integer'));\n    }\n    if (n === 0) return destResult.reset(null, 1);\n\n    var needed = Math.ceil(countBits(n) / 7);\n    return destResult.reset(null, needed);\n}\n\nfunction writeUnsignedVarIntInto(destResult, n, buffer, offset) {\n    if (typeof n !== 'number' || n < 0) {\n        // TODO: integer check\n        return destResult.reset(errors.expected(n, 'unsigned integer'), null);\n    }\n\n    var needed = Math.ceil(countBits(n) / 7);\n    var start = offset;\n    var end = offset + needed;\n\n    if (end > buffer.length) {\n        var remain = buffer.length - offset;\n        return WriteResult.poolShortError(destResult, needed, remain, offset);\n    }\n\n    offset = end;\n    while (offset > start) {\n        var b = n & 0x7f;\n        n >>= 7;\n        if (offset !== end) b |= 0x80;\n        buffer.writeUInt8(b, --offset, true);\n        if (n <= 0) break;\n    }\n\n    return destResult.reset(null, end);\n}\n\nfunction readUnsignedVarIntFrom(destResult, buffer, offset) {\n    var start = offset;\n    var n = 0;\n    while (offset < buffer.length) {\n        var b = buffer.readUInt8(offset++, true);\n        if (n !== 0) n <<= 7;\n        n += b & 0x7f;\n        if (!(b & 0x80)) {\n            return destResult.reset(null, offset, n);\n        }\n    }\n    var got = offset - start;\n    return ReadResult.poolShortError(destResult, got + 1, got, start, offset);\n}\n\nfunction countBits(n) {\n    var res = 1;\n    while (n >>= 1) res++;\n    return res;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}